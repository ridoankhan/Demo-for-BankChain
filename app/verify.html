<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Leadschain</title>
    <link href="../app/css/bootstrap.min.css" rel="stylesheet">
    <link href="../app/css/font-awesome.min.css" rel="stylesheet">
    <link href="../app/css/datepicker3.css" rel="stylesheet">
    <link href="../app/css/styles.css" rel="stylesheet">
    <link href="../app/forntend/css/style.css" rel="stylesheet">
    <link href="../app/css/jquery-ui.css" rel="stylesheet">

    <!--Custom Font-->
    <link rel="stylesheet" type="text/css" href="../app/forntend/css/mobirise.css" />
    <link rel="stylesheet" href="../app/forntend/css/magnific-popup.css">
    <link rel="stylesheet" type="text/css" href="../app/forntend/css/materialdesignicons.min.css" />
    <style>
        .tableFont {
            font-size: 10px;
        }
    </style>

</head>

<body>
    <nav class="navbar navbar-custom navbar-fixed-top" role="navigation">
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#sidebar-collapse"><span
                        class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span></button>
                <a class="navbar-brand" href="#"><span>LEADS Chain</span></a>

            </div>
        </div>
        <!-- /.container-fluid -->
    </nav>

    <!--/.sidebar-->

    <div class="col-12">
        <div class="col-12">

            <div class="row">
                <div class="col-12">
                    <div class="panel-heading"><img src="../app/img/dbbl_baner.png" class="img-responsive" style="position:absolute;top:100px;left: 50%;
                        transform: translateX(-50%) translateY(-50%);white-space:nowrap" />
                        <div class="panel panel-default">

                            <div class="panel-body">
                                <div class="row">


                                    <!--<div class="col-8">
										<h6 style="text-align: right" id="datetimetxt">
										</h6>
										<h6 style="text-align: left">101:Local Office
											1, Dilkusha Commercial Area, Dhaka-1000,Bangladesh</h6>
										<h6 style="text-align: left">DBBL Swift Code: DBBL BDDH</h6>
										<h6 style="text-align: left">DBBL Call Center: 16216 (24 Hours)</h6>
									</div>
									<div class="col-4">
										<div id="qrCode" style="height:160px; width:160px;" class="pull-right"></div>
									</div>-->

                                </div>
                                <div class="col-md-12">
                                    <br>
                                    <h3 style="text-align:center;font-weight: 600"><u>Verify Page</u></h3>

                                </div>


                                <div class="col-12">
                                    <h4 style="margin-top: 2%;color: black;font-weight: 400">Customer Information:</h4>

                                </div>
                                <div class="col-12">
                                    <table class="table table-responsive" style="table-layout: fixed;">
                                        <tbody>
                                            <tr>

                                                <td style="width: 30%;font-size:initial;color: black">Customer No</td>
                                                <td>:</td>
                                                <td style="width: 65%"><span id="customerIDTd"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Full Name</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="fullNameIDTd"></span></td>
                                            </tr>


                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Phone</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="phoneIDTd"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Email</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="emailIDTd"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Tin No</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="tinNoIDTd"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">National Id No</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="nationalIDNoTd"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Passport No</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="PassNolabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">A/C No</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="accNolabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">A/C Title</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="accTitlelabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">A/C Type</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="accTypelabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">A/C OpenDate</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="accOpendatelabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Currency</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="currencylabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Balance</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="Balancelabel"></span></td>
                                            </tr>
                                            <tr>

                                                <td style="width: 25%;font-size:initial;color: black">Balance In Word</td>
                                                <td>:</td>
                                                <td style="width: 70%"><span id="balanceWordlabel"></span></td>
                                            </tr>


                                        </tbody>
                                    </table>

                                </div>

                                <div class="text-center">
                                    <div><button type="button" class="btn btn-primary" id="verifyButton">Verify</button>
                                    </div>
                                    <br /><br />
                                    <div id="verifyIconSuccess">
                                        <h3 class="mdi mdi-verified text-success">Verified</h3>
                                    </div>
                                    <div id="verifyIconFail">
                                        <h3 class="mdi mdi-close-circle-outline text-danger">Not Verified</h3>
                                    </div>
                                    <br /><br />
                                    <div id="one">
                                        <p>Computing Hash Code of local certificate. <i id="iconOne" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div id="two">
                                        <p>Fetching hash in OP_RETURN field form ethereum Blockchain. <i id="iconTwo" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div id="three">
                                        <p>Comparing local and blockchain hashes. <i id="iconThree" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div id="four">
                                        <p>Checking LEADS<i class="mdi mdi-link-variant"></i>chain signature. <i id="iconFour" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div id="five">
                                        <p>Checking not revoked by issuer. <i id="iconFive" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div id="six">
                                        <h3 class="text-success">Success! The certificate has been verified. <i id="iconSix" class="mdi mdi-check-circle-outline"></i></p>
                                    </div>
                                    <div>
                                        <p style="overflow: auto">Blockchain Address:
                                            <a href="" id="blockAddress"></a>
                                        </p>
                                    </div>
                                    <ul id="ulEmployee">

                                    </ul>

                                </div>
                            </div>
                            <!-- /.panel-->
                        </div>
                    </div>
                </div>
                <!--/.row-->







            </div>
            <!--/.row-->
        </div>
        <!--/.main-->

        <!--<script src="js/jquery-1.11.1.min.js"></script>-->
        <script src="../app/js/jquery-3.2.1.min.js"></script>
        <script src="../app/js/jquery-ui.js"></script>

        <script src="../app/js/bootstrap.min.js"></script>
        <script src="../app/js/chart.min.js"></script>
        <script src="../app/js/chart-data.js"></script>
        <script src="../app/js/easypiechart.js"></script>
        <script src="../app/js/easypiechart-data.js"></script>
        <script src="../app/js/bootstrap-datepicker.js"></script>
        <script src="../app/js/custom.js"></script>
        <script src="../app/js/style.js"></script>
        <script src="./app.js"></script>
        <script src="../app/js/qrcode.js"></script>

        <script type="text/javascript">
            $(document).ready(function() {
                $("#verifyIconSuccess").hide();
                $("#verifyIconFail").hide();
                $("#one").hide();
                $("#two").hide();
                $("#three").hide();
                $("#four").hide();
                $("#five").hide();
                $("#six").hide();
                $("#iconOne").hide();
                $("#iconTwo").hide();
                $("#iconThree").hide();
                $("#iconFour").hide();
                $("#iconFive").hide();
                $("#iconSix").hide();
                $("#verifyIconFail").hide();

                var getUrlParameter = function getUrlParameter(sParam) {
                    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
                        sURLVariables = sPageURL.split('?'),
                        sParameterName,
                        i;

                    for (i = 0; i < sURLVariables.length; i++) {
                        sParameterName = sURLVariables[i].split('=');

                        if (sParameterName[0] === sParam) {
                            return sParameterName[1] === undefined ? true : sParameterName[1];
                        }
                    }
                };

                var txHash = getUrlParameter('txhash');
                console.log(txHash);


                var ajax = $.ajax({
                    url: 'http://115.127.24.181:57838/api/TxhashTables/Loadinfo?txhash=' + txHash,
                    method: 'GET',
                    dataType: 'json',
                    success: function(response) {
                        console.log(response);
                        for (var i = 0; i < response.length; i++) {
                            console.log(response[i].CustomerNo);
                            document.getElementById("customerIDTd").innerHTML = response[i].CustomerNo;
                            document.getElementById("fullNameIDTd").innerHTML = response[i].FullName;
                            document.getElementById("phoneIDTd").innerHTML = response[i].Phone;
                            document.getElementById("emailIDTd").innerHTML = response[i].Email;
                            document.getElementById("tinNoIDTd").innerHTML = response[i].TinNo;
                            document.getElementById("nationalIDNoTd").innerHTML = response[i].NidNo;
                            document.getElementById("PassNolabel").innerHTML = response[i].PassportNo;
                            document.getElementById("accNolabel").innerHTML = response[i].AccountNo;
                            document.getElementById("accTitlelabel").innerHTML = response[i].AccountTitle;
                            document.getElementById("accTypelabel").innerHTML = response[i].AccountType;
                            document.getElementById("accOpendatelabel").innerHTML = response[i].AccountOpendate;
                            document.getElementById("currencylabel").innerHTML = response[i].Currency;
                            document.getElementById("Balancelabel").innerHTML = response[i].Balance;
                            document.getElementById("balanceWordlabel").innerHTML = response[i].BalanceInWord;
                        }
                    },
                    error: function(response) {
                        console.log(response);
                        alert("There is Something Wrong");
                    }
                });
                $("#blockAddress").attr('href', 'https://ropsten.etherscan.io/tx/' + txHash);
                $("#blockAddress").text(txHash);
                console.log(txHash)

                $("#verifyButton").click(function() {
                    var a = 'https://api-ropsten.etherscan.io/api?module=transaction&action=gettxreceiptstatus&txhash=' +
                        txHash + '&apikey=BVC35V9UZRK9YAA4S4CP68YBNUKXMTFSCK';
                    var url = 'http://115.127.24.181:57838/api/TxhashTables/GetCustomerInfoByTxHash?txhash=' + txHash;

                    $.ajax({
                        url: 'http://115.127.24.181:57838/api/TxhashTables/Loadinfo?txhash=' + txHash,
                        method: 'GET',
                        dataType: 'json',
                        success: function(response) {
                            console.log(response);
                            /*var txTableData;
                            var test;
                            for (var r in response) {
                                console.log(response[r].TxhashTables);
                                txTableData = response[r].TxhashTables;
                                for (var v in txTableData) {
                                    if (txTableData[v] = txHash) {
                                        test = 1;
                                        console.log("True");
                                    } else {
                                        test = 0;
                                        console.log("False");
                                    }
                                }
                            }
                            if (test == 1) {
                            } else if (statusCode == "") {
                                $("#verifyIconFail").show();
                            }*/
                            if (response.length > 0) {
                                $("#one").fadeIn(1237, function() {
                                    $("#iconOne").fadeIn(300);
                                    $("#two").fadeIn(1152, function() {
                                        $("#iconTwo").fadeIn(350);
                                        $("#three").fadeIn(1346, function() {
                                            $("#iconThree").fadeIn(323);
                                            $("#four").fadeIn(1390,
                                                function() {
                                                    $("#iconFour").fadeIn(
                                                        312);
                                                    $("#five").fadeIn(
                                                        1058,
                                                        function() {
                                                            $(
                                                                    "#iconFive"
                                                                )
                                                                .fadeIn(
                                                                    320
                                                                );
                                                            $(
                                                                    "#six"
                                                                )
                                                                .fadeIn(
                                                                    1817,
                                                                    function() {
                                                                        $
                                                                            (
                                                                                "#iconSix"
                                                                            )
                                                                            .fadeIn(
                                                                                300
                                                                            );
                                                                        $
                                                                            (
                                                                                "#verifyIconSuccess"
                                                                            )
                                                                            .show();
                                                                    }
                                                                );
                                                        });
                                                });
                                        });
                                    });

                                });
                            } else {
                                $("#verifyIconFail").show();
                            }
                        },

                        error: function(response) {
                            console.log(response);
                            $("#verifyIconFail").show();
                        }

                    });
                });
            });
        </script>

</body>

</html>